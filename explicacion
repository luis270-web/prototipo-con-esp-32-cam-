Este programa implementa un sistema de detección de objetos utilizando un ESP32-CAM, un modelo de Edge Impulse, una pantalla OLED SSD1306 y tres LEDs de estado. El objetivo principal es capturar imágenes con la cámara, procesarlas mediante un modelo de inteligencia artificial y mostrar los resultados tanto en pantalla como a través de los LEDs.

1. Configuración del Hardware
Cámara ESP32-CAM AI Thinker
Se define el modelo de cámara y los pines utilizados por el módulo:
Pines de datos: Y2 – Y9
Formato de la imagen: JPEG
Esta configuración permite capturar imágenes adecuadas para el modelo de Edge Impulse.
2. Pantalla OLED SSD1306
La pantalla se comunica por I2C, con los pines:
SDA → GPIO 15
SCL → GPIO 14
Se usa la librería Adafruit_SSD1306, con tamaño:
128×64 píxeles
La pantalla se utiliza para mostrar mensajes del sistema y resultados de detección.
3. LEDs de Estado
Se conectan tres LEDs para indicar el estado del sistema:
LED	Pin	Significado
Azul	12	Sin detección / estado inicial
Verde	13	Objeto "lufy" detectado
Rojo	2	Objeto "toga" detectado
Estos LEDs permiten visualizar la clasificación sin depender de la pantalla.
4. Inicialización del Sistema (setup)
En la función setup() se realizan los siguientes pasos:
Inicialización del puerto serial (115200 baudios).
Inicio del bus I2C y de la pantalla OLED.
Configuración de los LEDs como salidas.
Encendido inicial del LED azul.
Inicialización de la cámara mediante ei_camera_init().
Mensaje de espera de 2 segundos antes de iniciar la inferencia continua.
5. Ciclo Principal (loop)
Dentro de loop() se ejecuta continuamente el proceso de:
Captura de imagen
Se reserva memoria para el búfer de imagen.
Se captura una foto con ei_camera_capture().
Se convierte la imagen JPEG a formato RGB888.
Se ajusta al tamaño requerido por el modelo.
Preparación del modelo
Se genera un objeto signal que contiene cada píxel convertido para utilizarlo en el algoritmo de Edge Impulse.
Inferencia
Se ejecuta el modelo usando:
run_classifier(&signal, &result, debug_nn);
El modelo devuelve:
Coordenadas de los objetos detectados (si es detección por bounding boxes).
Nombres de las clases detectadas.
Porcentajes de confianza.
Tiempos de procesamiento (DSP, clasificación y anomalía).
6. Procesamiento de Resultados
Detección de Objetos
Si el modelo está configurado como detector, se revisan las cajas detectadas:
Se muestra en pantalla la etiqueta y el porcentaje.
Se identifica si se detectó:
"lufy"
"toga"
Control de LEDs según la detección
Detección	LED azul	LED verde	LED rojo
Nada detectado	ON	OFF	OFF
lufy	OFF	ON	OFF
toga	OFF	OFF	ON
Otro objeto	ON	OFF	OFF
Mensaje en OLED
Si hay detección: muestra la etiqueta y el porcentaje.
Si no hay detección: imprime “No detecto”.
7. Funciones Internas Importantes
ei_camera_init()
Inicializa la cámara con los parámetros establecidos.
Ajusta brillo, saturación y volteo de imagen si el sensor es OV3660.
ei_camera_capture()
Captura la imagen.
Convierte JPEG → RGB888.
Reduce o recorta la imagen al tamaño del modelo.
ei_camera_get_data()
Convierte valores RGB a formato entero para los algoritmos internos de Edge Impulse.